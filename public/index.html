<!DOCTYPE html>
<html lang="en" xmlns="">
<head>
    <meta charset="UTF-8">
    <title>Scouting App</title>
    <link rel="stylesheet" href="node_modules/onsenui/css/onsenui.css">
    <link rel="stylesheet" href="node_modules/onsenui/css/onsen-css-components.css">
    <script src="node_modules/onsenui/js/onsenui.js"></script>
    <link rel="stylesheet" href="node_modules/font-awesome-animation/dist/font-awesome-animation.min.css">
    <script src="node_modules/axios/dist/axios.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.9.1/firebase.js"></script>
    <script src="node_modules/chart.js/dist/Chart.min.js"></script>
    <script src="node_modules/chartjs-chart-box-and-violin-plot/build/Chart.BoxPlot.js"></script>
    <!-- <script src="https://cdn.auth0.com/js/auth0/9.2.2/auth0.min.js"></script> -->
    <script src="node_modules/firebaseui/dist/firebaseui.js"></script>
    <link type="text/css" rel="stylesheet" href="node_modules/firebaseui/dist/firebaseui.css" />
    <script src="node_modules/xlsx/dist/xlsx.full.min.js" async></script>
    <script src="main.js"></script>
    <script src="node_modules/moment/min/moment.min.js"></script>
    <script src="node_modules/lodash/lodash.min.js"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
    <link rel="stylesheet" href="res/main.css"/>
    <!--<link rel="manifest" href="manifest.json">-->
</head>

<body>
<ons-navigator id="appNavigator" swipeable swipe-target-width="80px">
    <ons-page id="tabbarPage">
        <ons-splitter id="appSplitter">
            <ons-splitter-content page="login.html"></ons-splitter-content>
        </ons-splitter>
    </ons-page>
</ons-navigator>

<template id="login.html">
    <ons-page id="login">
        <div style="text-align: center; margin-top: 30px;" id="firebaseui-auth-container">
        </div>
    </ons-page>
</template>

<template id="tabbar.html">
    <ons-page id="tabbar-page">
        <ons-toolbar>
            <div class="center">Home</div>
        </ons-toolbar>
        <ons-tabbar swipeable id="appTabbar" position="auto">
            <ons-tab label="Matches" icon="ion-edit" page="scout-matches.html" active></ons-tab>
            <ons-tab label="Teams" icon="ion-home" page="home.html"></ons-tab>
            <ons-tab label="View Teams" icon="ion-edit" page="teams.html"></ons-tab>
            <ons-tab label="Settings" icon="ion-settings" page="settings.html"></ons-tab>
        </ons-tabbar>

        <script>
            ons.getScriptPage().addEventListener('prechange', function (event) {
                if (event.target.matches('#appTabbar')) {
                    event.currentTarget.querySelector('ons-toolbar .center').innerHTML = event.tabItem.getAttribute('label');
                }
            });
        </script>
    </ons-page>
</template>

<template id="inspect-team-data.html">
    <ons-page id="inspect-team-data">
        <ons-toolbar>
            <div class="left"><ons-back-button>All Teams</ons-back-button></div>
            <div class="center">Team <span id="team-num"></span></div>
        </ons-toolbar>
        <div style="text-align:center; padding: 5px;">
            <h1 id="team-name"></h1>
            <div id="autostats">
                <h2>Autonomous</h2>
                <canvas id="autoMove"></canvas>
                <hr style="margin: 10px 0px;" />
                <canvas id="autochart"></canvas>
            </div>
            <hr />
            <div id="teleopstats">
                <h2>Teleop</h2>
                <canvas id="teleopchart"></canvas>
            </div>
            <hr />
            <div id="endgamestats">
                <h2>End Game</h2>
                <canvas id="endgamechart"></canvas>
            </div>
            <hr />
            <div>
                <h2>Win/Loss Record: <span id="record-win"></span>-<span id="record-loss"></span></h2>
                <h2>Rank: <span id="qual-rank"></span></h2>
                <div id="match-view">                 
                </div>
            </div>
        </div>
    </ons-page>
</template>

<template id="teams.html">
    <ons-page id="rank-teams">
        <div id="teams-ranked">
        </div>
    </ons-page>
</template>

<template id="scout-matches.html">
    <ons-page id="scout-matches">
        <ons-toolbar>
            <ons-list-item class="center" style="margin-top: 5px;">
                <div>View Past Matches</div>
                <div style="margin-left: 20px;"><ons-switch></ons-switch></div>
            </ons-list-item>
        </ons-toolbar>
        <div class="loading"><ons-icon id="loading-icon" size="22px" spin="true" icon="fa-spinner"></ons-icon></div>
        <ons-list id="matches-list">
        </ons-list>
    </ons-page>
</template>

<template id="home.html">
    <ons-page id="home">
        <ons-toolbar>
            <div class="center" style="margin-top: 5px"><ons-search-input class="center"></ons-search-input></div>
        </ons-toolbar>
        <div class="loading"><ons-icon id="loading-icon" size="22px" spin="true" icon="fa-spinner"></ons-icon></div>
        <ons-list id="teams-list">
        </ons-list>
    </ons-page>
</template>

<template id = "settings.html">
    <ons-page id = "settingsPage" data-dirty="y">
        <div style="padding: 15px;">
            <div style="text-align: center"><h2>Rank Criteria</h2></div>
            <div id="rank-criteria">
                <p id="auto-switch-crit">Autonomous Switch: <span></span>%<ons-button>Max</ons-button><ons-range></ons-range></p>
                <p id="auto-scale-crit">Autonomous Scale: <span></span>%<ons-button>Max</ons-button><ons-range></ons-range></p>
                <p id="teleop-switch-crit">Teleop Switch: <span></span>%<ons-button>Max</ons-button><ons-range></ons-range></p>
                <p id="teleop-scale-crit">Teleop Scale: <span></span>%<ons-button>Max</ons-button><ons-range></ons-range></p>
                <p id="vault-crit">Vault: <span></span>%<ons-button>Max</ons-button><ons-range></ons-range></p>
                <p id="endgame-crit">Endgame: <span></span>%<ons-button>Max</ons-button><ons-range></ons-range></p>
                <p id="bias-crit">Bias toward recent games: <span></span>%<ons-button>Max</ons-button><ons-range></ons-range></p>
            </div>
	        <div>
		        <h4 style = "padding-right: 8%; font-size: 99%">Tournament:</h4>
                <ons-select id="tournament" style = "float: left">
                    <option value="Albany">Albany</option>
                    <option value="Gainesville">Gainesville</option>
                    <option value="Peachtree">Peachtree</option>
                            <!--<option value="Houston">Houston</option>-->
                </ons-select>
	        </div><br />
            <p id="settings-btns"><ons-button onclick="firebase.auth().signOut().then(() => location.reload())">Logout</ons-button>
            <ons-button onclick="matchesExport().then(wb => XLSX.writeFile(wb, 'scouting-data.ods'));">Export Match Scouting Data</ons-button>
            <ons-button onclick="alert('Not implemented')">Export Pit Scouting Data</ons-button></p>
        </div>
    </ons-page>
</template>

<template id="team-scout.html">
    <ons-page id="team-scout" class="scout-page">
        <ons-toolbar>
            <div class="left">
                <ons-back-button>Home</ons-back-button>
            </div>
            <div class="center" id="team-title">
            </div>
        </ons-toolbar>
        <h2 style="text-align: center;">Team Scouting</h2>
        <div id="intro-btns" class="btns">
            <!-- What to do if preexisting data is found-->
            <ons-card id="match" modifier="large">
                <div class="title">Match</div>
                <div class="content">When scouting for a real match</div>
            </ons-card>
            <ons-card id="pit" modifier="large">
                <div class="title">Pit</div>
                <div class="content">Simply asking questions</div>
            </ons-card>
            <ons-card id="pic" modifier="large">
                <div class="title">Picture</div>
                <div class="content">Take a picture of the robot</div>
            </ons-card>
        </div>
    </ons-page>
</template>

<template id="match-scout.html">
    <ons-page id="match-scout" class="scout-page">
        <ons-toolbar>
            <div class="left"><ons-back-button></ons-back-button></div>
            <div class="center" id="team-title">Team <span id="team-num"></span> Match Scouting</div>
        </ons-toolbar>
        <h2 id="team-name"></h2>
        <div id="match-btns" class="btns">
            <form style="padding: 5px;">
            <div>
                <em>Match Number:</em>
                <ons-input type="number" value="0" min="0" required style="width: 10%;" id="match-num"></ons-input>
            </div>
            <div id="autonomous">
                <h3>Autonomous</h3>
                Did they move:<br />
                <div id="auto-move" class="btn-select-menu">
                    <ons-button modifier="large" data-select="dline">Drive across line</ons-button>
                    <ons-button modifier="large" data-select="move">Moved but did not cross line</ons-button>
                    <ons-button modifier="large" data-select="none">Did not move</ons-button>
                </div>
                Choose target (If none, leave blank):<br />
                <div id="auto-target" class="btn-select-menu">
                    <ons-button modifier="large" data-select="sswitch" disabled>Switch (Same side)</ons-button>
                    <ons-button modifier="large" data-select="cswitch" disabled>Switch (Cross side)</ons-button>
                    <ons-button modifier="large" data-select="sscale" disabled>Scale (Same side)</ons-button>
                    <ons-button modifier="large" data-select="cscale" disabled>Scale (Cross side)</ons-button>
                </div>
                <div id="auto-target-result" class="btn-select-menu">
                    <ons-button disabled data-select="true">Success</ons-button>
                    <ons-button disabled data-select="false">Failure</ons-button>
                </div>
            </div>
            <hr />
            <div id="teleop">
                <h3>Teleoperated</h3>
                <div id="teleop-run">
                    <p id="teleop-switch">Switch blocks:<br/>
                        <ons-button class="minus"><ons-icon icon="md-minus"></ons-icon></ons-button>
                        <ons-input type="number" value="0" min="0" required></ons-input>
                        <ons-button class="plus"><ons-icon icon="md-plus"></ons-icon></ons-button>
                    </p>
                    <p id="teleop-scale">Scale blocks:<br/>
                        <ons-button class="minus"><ons-icon icon="md-minus"></ons-icon></ons-button>
                        <ons-input type="number" value="0" min="0" required></ons-input>
                        <ons-button class="plus"><ons-icon icon="md-plus"></ons-icon></ons-button>
                    </p>
                    <p id="teleop-vault">Vault blocks:<br />
                        <ons-button class="minus"><ons-icon icon="md-minus"></ons-icon></ons-button>
                        <ons-input type="number" value="0" min="0" required></ons-input>
                        <ons-button class="plus"><ons-icon icon="md-plus"></ons-icon></ons-button>
                    </p>
                </div>
            </div>
            <hr />
            <div id="end-game">
                <h3>End Game</h3>
                <p>Leave blank for none</p>
                <div id="end-game-menu" class="btn-select-menu">
                    <ons-button modifier="large" data-select="climb">Climb (e.g. with rope/hook)</ons-button>
                    <ons-button modifier="large" data-select="ramps">Ramps</ons-button>
                    <ons-button modifier="large" data-select="other">Other (raised)</ons-button>
                    <ons-button modifier="large" data-select="parked">Parked (not raised)</ons-button>
                </div>
                <div id="end-game-result" class="btn-select-menu">
                    <ons-button disabled data-select="true">Success</ons-button>
                    <ons-button disabled data-select="false">Failure</ons-button>
                </div>
            </div>
            <hr />
            <textarea placeholder="Comments (optional)"></textarea>
            <button id="submit-match" class="button button--material"> <!-- Slight hack but this should get around form validation -->
                <span id="submit-text">Submit</span>
                <span id="submit-load" style="display: none;"><ons-icon icon="ion-load-c" spin size="26px"></ons-icon></span>
                <span id="submit-done" style="display: none;"><ons-icon icon="ion-checkmark-circled" size="26px"></ons-icon></span>
            </button>
            </form>
        </div>
    </ons-page>
</template>

<template id="pit-scout.html">
        <ons-page id="pit-scout" class="scout-page">
            <ons-toolbar>
                <div class="left"><ons-back-button></ons-back-button></div>
                <div class="center" id="team-title">Team <span id="team-num"></span> Pit Scouting</div>
            </ons-toolbar>
            <div class = "pitTitle">
                <h2 style = "font-size: x-small"><span id="team-name"></span></h2>
    	    </div>
            <form class="btns">
                <div>
                    <h2 id = "driveTrainHeading" style = "margin-bottom: 0%; padding-bottom: 0%">Drive Train Type:</h2>
                    <div class="select-one" id="drivetrain-select">
                        <ons-button modifier="large" data-select="tank">Tank</ons-button>
                        <ons-button modifier="large" data-select="swerve">Swerve</ons-button>
                        <ons-button modifier="large" data-select="mecanum">Mecanum</ons-button>
                        <ons-button modifier="large" data-select="slide">Slide</ons-button>
                        <ons-button modifier="large" data-select="holonomic">Holonomic</ons-button>
                    </div>
                </div>
                <div class = "pitScout">
                    <h2>Focus:</h2><br />
                    <div class="select-many" id="focus">
                        <ons-button modifier="large" data-select="0">Switch</ons-button>
                        <ons-button modifier="large" data-select="1">Scale</ons-button>
                        <ons-button modifier="large" data-select="2">Defense</ons-button>
                    </div>
                </div>
                <div class = "pitScout">
                    <h2>Capabilities:</h2><br />
                    <div class = "CheckBoxPit select-many" id="capabilities">
                        <ons-button modifier="large" data-select="0">Switch</ons-button>
                        <ons-button modifier="large" data-select="1">Scale</ons-button>
                    </div>
                    
                    <div id = "insertHeight">
                        <h4>Robot's Max Lift Height:</h4>
                        <ons-input type="number" id="heightInput" required min="0"></ons-input> 
                        <h5>inches</h5>
                    </div>
                </div>
               
                <div class="pitScout" style = "margin-top:10%">
                    <h2 style="margin-top: 4%" >End Game Strategy:</h2>
                    <div class="CheckBoxPit select-one" id="endgame-strategy">
                        <ons-button modifier="large" data-select="ramps">Ramps</ons-button>
                        <ons-button modifier="large" data-select="climb">Climb</ons-button>
                    </div><br/>
                    <textarea placeholder="Additional Systems" id="more-comments"></textarea>
                    <button id="submit-pit" class="button button--material" style="margin-left: auto; margin-right: auto;"> <!-- Slight hack but this should get around form validation -->
                        <span id="submit-text">Submit</span>
                        <span id="submit-load" style="display: none;"><ons-icon icon="ion-load-c" spin size="26px"></ons-icon></span>
                        <span id="submit-done" style="display: none;"><ons-icon icon="ion-checkmark-circled" size="26px"></ons-icon></span>
                    </button>
                </div>
            </form>
        </ons-page>
    </template>

<template id="pic-scout.html">
    <ons-page id="pic-scout" class="scout-page">
        <ons-toolbar>
            <div class="left"><ons-back-button></ons-back-button></div>
            <div class="center" id="team-title">Team <span id="team-num"></span></div>
        </ons-toolbar>
        <forms>
            <div class="content">Add a Picture to the team</div>
        </forms>
    </ons-page>
</template>

<script>
    window.fn = {};

    window.fn.toggleMenu = function () {
        document.getElementById('appSplitter').right.toggle();
    };

    window.fn.loadView = function (index) {
        document.getElementById('appTabbar').setActiveTab(index);
        document.getElementById('sidemenu').close();
    };

    window.fn.loadLink = function (url) {
        window.open(url, '_blank');
    };

    window.fn.pushPage = function (page, anim) {
        if (anim) {
            document.getElementById('appNavigator').pushPage(page.id, {data: {title: page.title}, animation: anim});
        } else {
            document.getElementById('appNavigator').pushPage(page.id, {data: {title: page.title}});
        }
    };
    window.fn.toggle = function (el) {
        el.classList.toggle("active");
    };

    window.fn.checkForPrevAuth = function () {

        if (localStorage.auth === "1") {
            document.getElementById('appNavigator').pushPage('tabbar.html');
        }
    };

</script>
<script>

</script>
</body>
</html>
